<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Transfer Pembayaran</title>
<link rel="icon" href="https://validusgrp.com/wp-content/themes/validus/favicon.ico">
<style>
:root{
  --bg:#0f1720;
  --card: rgba(255,255,255,0.1);
  --text:#e6eef8;
  --accent:#102e58;
  --muted:rgba(230,238,248,0.7);
  --success:#16a34a;
  --danger:#d32f2f;
  --glass: rgba(255,255,255,0.06);
}
html,body{
  height:100%;
  margin:0;
  font-family:Inter, Arial, sans-serif;
  background:var(--bg);
  color:var(--text);
}
.page {
  position: relative;
  min-height:100vh;
  padding:88px 16px 48px;
  overflow:hidden;
}
.page::before {
  content:"";
  position:fixed;
  top:0; left:0; right:0; bottom:0;
  background-image:url('https://images.pexels.com/photos/4147341/pexels-photo-4147341.jpeg');
  background-size:cover;
  background-position:center;
  z-index:-2;
  filter: brightness(0.9);
}
.page::after {
  content:"";
  position:fixed;
  top:0; left:0; right:0; bottom:0;
  backdrop-filter: blur(4px);
  background-color: rgba(15,23,32,0.2);
  z-index:-1;
  pointer-events:none;
}

header{
  position:fixed;
  top:0; left:0; right:0;
  height:64px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:10px 18px;
  background:var(--glass);
  backdrop-filter: blur(6px);
  z-index:2000;
}
.brand img{height:36px;}

#loadingOverlay{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:10px;
  background: rgba(0,0,0,0.5);
  z-index:1500;
  color:var(--text);
  font-weight:600;
}
.spinner {
  width:40px; height:40px;
  border:5px solid rgba(255,255,255,0.2);
  border-top-color:var(--accent);
  border-radius:50%;
  animation:spin 1s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}

.card {
  max-width:520px;
  margin:40px auto;
  background:var(--card);
  border-radius:12px;
  padding:24px;
  backdrop-filter: blur(6px);
  color: var(--text);
  display:none;
}
.bank-logo{
  display:block;
  margin:8px auto 18px;
  width:160px; height:auto;
  object-fit:contain;
}
.rekening-info { text-align:center; margin-bottom: 18px; }
.rekening-info strong { display:block; margin-top: 8px; color: var(--muted); font-size: 13px; }
.rekening-info > div { font-weight: 700; font-size: 20px; margin-top: 4px; }
.rekening-number { font-size: 20px; }
.success { color: var(--success); margin-top: 6px; display: none; }
.section { text-align:center; margin-bottom:18px; }
.label{font-size:13px; color:var(--muted); margin-bottom:6px;}
.input-row { display:flex; gap:10px; justify-content:center; margin-top:10px; }
.amount-input { padding:10px 12px; border-radius:8px; border:1px solid rgba(0,0,0,0.08); width:100%; max-width:300px; text-align:center; font-weight:700;}
.btn { display:inline-block; padding:10px 12px; background:var(--accent); color:#fff; border-radius:8px; border:none; cursor:pointer; font-weight:700; text-decoration:none;}
.instructions { text-align:left; color:var(--muted); font-size:13px; margin-top:14px; line-height:1.4; }
.footer-note { text-align:center; font-size:12px; color:var(--muted); margin-top:12px; }

@media (max-width:520px){
  .card{ margin:24px 18px; padding:18px;}
}
</style>
</head>
<body>
<header>
  <div class="brand">
    <img src="https://validusgrp.com/wp-content/uploads/2022/04/validus-capital-logo-red.png" alt="Brand" />
  </div>
</header>

<main class="page">
<div id="loadingOverlay">
  <div class="spinner"></div>
  <div id="loadingText">Memuat data rekening...</div>
</div>

<article class="card" id="card">
  <img id="bankLogo" class="bank-logo" src="" alt="Logo Bank">
  <div class="rekening-info">
    <strong>Nama Rekening:</strong> <div id="holderName">-</div>
    <strong>Nomor Rekening:</strong> <div class="rekening-number" id="acctNumber">-</div>
    <button class="btn" id="copyAcctBtn">Salin Nomor Rekening</button>
    <div class="success" id="copy-number-success">✅ Nomor rekening berhasil disalin</div>
  </div>
  <div class="section">
    <div class="label">Jumlah Transfer (Rp)</div>
    <div class="input-row">
      <input type="text" id="amountInput" class="amount-input" placeholder="Misal: 1500000" inputmode="numeric" />
      <button id="copyAmountBtn" class="btn">Salin</button>
    </div>
  </div>
  <a id="confirmBtn" class="btn" href="#" target="_blank">Saya sudah membayarkannya</a>
  <div class="instructions">
    <ol>
      <li>Salin nomor rekening, lalu transfer via online banking, mobile banking, atau ATM.</li>
      <li>Kirim bukti transfer ke mentor/guru. Jika belum melakukan pembayaran 15–20 menit, refresh halaman.</li>
    </ol>
  </div>
  <div class="footer-note">Copyright © <span id="year"></span> Validus. All rights reserved. </div>
</article>

<div class="toast" id="toast" style="display:none; position:fixed; right:18px; bottom:18px; background:var(--success); color:#fff; padding:10px 14px; border-radius:8px;">
  <span id="toastText">Berhasil disalin</span>
</div>
</main>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbyo4cv-kHFZYlKpDfauCDYAfqZB0dX-7d0r6i5d6oz8qRVwNyCk2INWYE9FbOyzezvr/exec";
const defaultLogo = "https://upload.wikimedia.org/wikipedia/commons/3/3f/Bank_icon.svg";
const bankLogos = {
  bri:"https://upload.wikimedia.org/wikipedia/commons/6/68/BANK_BRI_logo.svg",
  bca:"https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Bank_Central_Asia.svg/330px-Bank_Central_Asia.svg.png",
  danamon:"https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/Danamon.svg/330px-Danamon.svg.png",
  sinarmas:"https://www.sinarmas.com/blog/wp-content/uploads/2016/10/cropped-sm-logo-2.png",
  cimb:"https://upload.wikimedia.org/wikipedia/commons/thumb/3/38/CIMB_Niaga_logo.svg/330px-CIMB_Niaga_logo.svg.png",
  mandiri:"https://upload.wikimedia.org/wikipedia/commons/thumb/a/ad/Bank_Mandiri_logo_2016.svg/213px-Bank_Mandiri_logo_2016.svg.png",
  bni:"https://upload.wikimedia.org/wikipedia/commons/thumb/8/8e/BNI_logo.svg/330px-BNI_logo.svg.png"
};

const els = {
  loadingOverlay: document.getElementById('loadingOverlay'),
  loadingText: document.getElementById('loadingText'),
  bankLogo: document.getElementById('bankLogo'),
  holderName: document.getElementById('holderName'),
  acctNumber: document.getElementById('acctNumber'),
  copyAcctBtn: document.getElementById('copyAcctBtn'),
  amountInput: document.getElementById('amountInput'),
  copyAmountBtn: document.getElementById('copyAmountBtn'),
  confirmBtn: document.getElementById('confirmBtn'),
  toast: document.getElementById('toast'),
  toastText: document.getElementById('toastText'),
  yearEl: document.getElementById('year')
};

function showToast(msg){
  els.toastText.textContent = msg;
  els.toast.style.display='flex';
  setTimeout(()=>els.toast.style.display='none',2500);
}
function onlyDigits(s){ return (s||'').toString().replace(/[^\d]/g,''); }
function formatRp(n){ return n?('Rp '+Number(n).toLocaleString('id-ID')):''; }
function setBankLogoByName(name){
  let logo = defaultLogo;
  if(name){
    const key = name.toLowerCase();
    for(const k in bankLogos){ if(key.includes(k)){ logo=bankLogos[k]; break; } }
  }
  els.bankLogo.src = logo;
  els.bankLogo.alt = name?`Logo Bank ${name}`:"Logo Bank";
  els.bankLogo.onerror=function(){this.onerror=null;this.src=defaultLogo;};
}

els.copyAcctBtn.addEventListener('click',()=>{
  const txt = els.acctNumber.textContent||'';
  if(!txt||txt==='-') return;
  navigator.clipboard.writeText(onlyDigits(txt)).then(()=>showToast("Berhasil menyalin nomor rekening"));
});
els.copyAmountBtn.addEventListener('click',()=>{
  const val = onlyDigits(els.amountInput.value);
  if(!val) return alert('Masukkan jumlah transfer');
  navigator.clipboard.writeText(val).then(()=>showToast("Berhasil menyalin jumlah transfer"));
});
els.amountInput.addEventListener('input', e=>{
  const digits=onlyDigits(e.target.value);
  e.target.value = digits?formatRp(digits):'';
});

async function loadData(){
  try{
    const res = await fetch(API_URL,{cache:"no-store"});
    let data = {bank:'bri', name:'John Doe', number:'1234567890', amount:'1500000'};
    if(res.ok){
      const json = await res.json();
      data = (json&&json.data)?json.data:json;
    }
    setBankLogoByName(data.bank||'');
    els.holderName.textContent = data.name||'-';
    els.acctNumber.textContent = data.number||'-';
    if(data.amount) els.amountInput.value = formatRp(onlyDigits(data.amount));
  }catch(err){
    console.error("Fetch error:",err);
    els.loadingText.textContent = "Tidak bisa memuat data. Gunakan data default.";
  }finally{
    els.loadingOverlay.style.display='none';
    document.getElementById('card').style.display='block';
  }
}

(function init(){ els.yearEl.textContent = new Date().getFullYear(); loadData(); })();
</script>
</body>
</html>
