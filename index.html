<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Transfer Pembayaran</title>
<link rel="icon" href="https://validusgrp.com/wp-content/themes/validus/favicon.ico">
<style>
:root{
  --card: rgba(255,255,255,0.15);
  --text:#e6eef8;
  --accent:#102e58;
  --muted:rgba(230,238,248,0.7);
  --success:#16a34a;
  --danger:#d32f2f;
}
html,body{
  height:100%;
  margin:0;
  font-family:Inter, Arial, sans-serif;
  background:transparent; 
  color:var(--text);
}
.page {
  position: relative;
  min-height:100vh;
  padding:88px 16px 48px;
  overflow:hidden;
}
.page::before {
  content:"";
  position:fixed;
  top:0; left:0; right:0; bottom:0;
  background-image:url('https://images.pexels.com/photos/4147341/pexels-photo-4147341.jpeg');
  background-size:cover;
  background-position:center;
  z-index:-2;
  filter: brightness(1.9);
}
.page::after {
  content:"";
  position:fixed;
  top:0; left:0; right:0; bottom:0;
  backdrop-filter: blur(4px);
  background-color: rgba(255,255,255,0.05);
  z-index:-1;
  pointer-events:none;
}

header{
  position:fixed;
  top:0; left:0; right:0;
  height:64px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:10px 18px;
  background:rgba(255,255,255,0.05);
  backdrop-filter: blur(6px);
  z-index:2000;
}
.brand img{height:36px;}

.card {
  max-width:520px;
  margin:40px auto;
  background:var(--card);
  border-radius:12px;
  padding:24px;
  backdrop-filter: blur(6px);
  color: var(--text);
  display:none;
}
.bank-logo{
  display:block;
  margin:8px auto 18px;
  width:160px; height:auto;
  object-fit:contain;
}
.rekening-info { text-align:center; margin-bottom: 18px; }
.rekening-info strong { display:block; margin-top: 8px; color: var(--muted); font-size: 13px; }
.rekening-info > div { font-weight: 700; font-size: 20px; margin-top: 4px; }
.rekening-number { font-size: 20px; }
.success { color: var(--success); margin-top: 6px; display: none; }
.section { text-align:center; margin-bottom:18px; }
.label{font-size:13px; color:var(--muted); margin-bottom:6px;}
.input-row { display:flex; gap:10px; justify-content:center; margin-top:10px; }
.amount-input { padding:10px 12px; border-radius:8px; border:1px solid rgba(0,0,0,0.08); width:100%; max-width:300px; text-align:center; font-weight:700;}
.btn { display:inline-block; padding:10px 12px; background:var(--accent); color:#fff; border-radius:8px; border:none; cursor:pointer; font-weight:700; text-decoration:none;}
.instructions { text-align:left; color:var(--muted); font-size:13px; margin-top:14px; line-height:1.4; }
.footer-note { text-align:center; font-size:12px; color:var(--muted); margin-top:12px; }

#loadingOverlay{
  position:fixed; inset:0;
  display:flex;
  align-items:center; justify-content:center;
  gap:18px;
  background: rgba(0,0,0,0.3);
  z-index:1500;
  color:var(--text);
  font-weight:600;
  font-size:16px;
}
.spinner { width:56px; height:56px; border-radius:50%; border:6px solid rgba(255,255,255,0.12); border-top-color:var(--accent); animation:spin 1s linear infinite; }
@keyframes spin{to{transform:rotate(360deg)}}

@media (max-width:520px){
  .card{ margin:24px 18px; padding:18px;}
}
</style>
</head>
<body>
<header>
  <div class="brand">
    <img src="https://validusgrp.com/wp-content/uploads/2022/04/validus-capital-logo-red.png" alt="Brand" />
  </div>
</header>

<main class="page">
<div id="loadingOverlay" role="status" aria-live="polite">
  <div class="spinner" aria-hidden="true"></div>
  Memuat data rekening...
</div>

<article class="card" id="card">
  <img id="bankLogo" class="bank-logo" src="" alt="Logo Bank">
  <div class="rekening-info">
    <strong>Nama Rekening:</strong> <div id="holderName">-</div>
    <strong>Nomor Rekening:</strong> <div class="rekening-number" id="acctNumber">-</div>
    <button class="btn" id="copyAcctBtn">Salin Nomor Rekening</button>
    <div class="success" id="copy-number-success">✅ Nomor rekening berhasil disalin</div>
  </div>
  <div class="section">
    <div class="label">Jumlah Transfer (Rp)</div>
    <div class="input-row">
      <input type="text" id="amountInput" class="amount-input" placeholder="Misal: 1.500.000" inputmode="numeric" />
      <button id="copyAmountBtn" class="btn">Salin</button>
    </div>
  </div>
  <a id="confirmBtn" class="btn" href="#" target="_blank">Saya sudah membayarkannya</a>
  <div class="instructions">
    <ol>
      <li>Salin nomor rekening, lalu transfer via online banking, mobile banking, atau ATM.</li>
      <li>Kirim bukti transfer ke mentor/guru. Jika belum melakukan pembayaran 15–20 menit, refresh halaman.</li>
    </ol>
  </div>
  <div class="footer-note">Copyright © <span id="year"></span> Validus. All rights reserved.</div>
</article>

<div class="toast" id="toast" style="display:none; position:fixed; right:18px; bottom:18px; background:var(--success); color:#fff; padding:10px 14px; border-radius:8px;">
  <span id="toastText">Berhasil disalin</span>
</div>
</main>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbyo4cv-kHFZYlKpDfauCDYAfqZB0dX-7d0r6i5d6oz8qRVwNyCk2INWYE9FbOyzezvr/exec";
const defaultLogo = "https://upload.wikimedia.org/wikipedia/commons/3/3f/Bank_icon.svg";
const bankLogos = {
  bri:"https://upload.wikimedia.org/wikipedia/commons/6/68/BANK_BRI_logo.svg",
  bca:"https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Bank_Central_Asia.svg/330px-Bank_Central_Asia.svg.png",
  mandiri:"https://upload.wikimedia.org/wikipedia/commons/thumb/a/ad/Bank_Mandiri_logo_2016.svg/213px-Bank_Mandiri_logo_2016.svg.png",
  bni:"https://upload.wikimedia.org/wikipedia/commons/thumb/8/8e/BNI_logo.svg/330px-BNI_logo.svg.png"
};

const els = {
  loadingOverlay: document.getElementById('loadingOverlay'),
  bankLogo: document.getElementById('bankLogo'),
  holderName: document.getElementById('holderName'),
  acctNumber: document.getElementById('acctNumber'),
  copyAcctBtn: document.getElementById('copyAcctBtn'),
  amountInput: document.getElementById('amountInput'),
  copyAmountBtn: document.getElementById('copyAmountBtn'),
  toast: document.getElementById('toast'),
  toastText: document.getElementById('toastText'),
  yearEl: document.getElementById('year'),
  card: document.getElementById('card')
};

function showToast(msg){
  els.toastText.textContent = msg;
  els.toast.style.display='flex';
  setTimeout(()=>els.toast.style.display='none',2500);
}
function onlyDigits(s){ return (s||'').toString().replace(/[^\d]/g,''); }
function formatRp(n){ return n?('Rp '+Number(n).toLocaleString('id-ID')):''; }

function setBankLogoByName(name){
  let logo = defaultLogo;
  if(name){
    const key = name.toLowerCase();
    for(const k in bankLogos){
      if(key.includes(k)){ logo = bankLogos[k]; break; }
    }
  }
  els.bankLogo.src = logo;
  els.bankLogo.alt = name ? `Logo Bank ${name}` : "Logo Bank";
}

els.copyAcctBtn.addEventListener('click',()=>{
  const txt = els.acctNumber.textContent||'';
  if(!txt||txt==='-') return;
  navigator.clipboard.writeText(onlyDigits(txt)).then(()=>showToast("Berhasil menyalin nomor rekening"));
});
els.copyAmountBtn.addEventListener('click',()=>{
  const val = onlyDigits(els.amountInput.value);
  if(!val) return alert('Masukkan jumlah transfer');
  navigator.clipboard.writeText(val).then(()=>showToast("Berhasil menyalin jumlah transfer"));
});
els.amountInput.addEventListener('input', e=>{
  const digits = onlyDigits(e.target.value);
  e.target.value = digits?formatRp(digits):'';
});

els.yearEl.textContent = new Date().getFullYear();

// baca parameter URL
function readUrlParams(){
  const p = new URLSearchParams(window.location.search);
  return {
    bank: p.get('bank'),
    name: p.get('name'),
    number: p.get('number'),
    amount: p.get('amount')
  };
}

async function loadData(){
  const params = readUrlParams();
  try{
    const res = await fetch(API_URL,{cache:"no-store"});
    const json = await res.json();
    const data = json.data || json;

    const bank = params.bank || data.bank || 'bri';
    const name = params.name || data.name || data.nama || 'John Doe';
    const number = params.number || data.number || data.norek || '1234567890';
    const amount = params.amount || data.amount || data.nominal || '';

    setBankLogoByName(bank);
    els.holderName.textContent = name;
    els.acctNumber.textContent = number;
    if(amount) els.amountInput.value = formatRp(onlyDigits(amount));

  }catch(err){
    console.error(err);
    els.holderName.textContent = params.name || 'John Doe';
    els.acctNumber.textContent = params.number || '1234567890';
    if(params.amount) els.amountInput.value = formatRp(onlyDigits(params.amount));
    setBankLogoByName(params.bank || 'bri');
  }finally{
    setTimeout(()=>{
      els.loadingOverlay.style.display='none';
      els.card.style.display='block';
    },250);
  }
}

loadData();
</script>
</body>
</html>

